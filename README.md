# Абитура (Система управления абитуриентами)

[![Python Version](https://img.shields.io/badge/python-3.8%2B-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Tkinter](https://img.shields.io/badge/GUI-Tkinter-orange.svg)](https://docs.python.org/3/library/tkinter.html)

# Система учета абитуриентов

## Описание проекта

Настольное приложение для автоматизированного управления данными о поступающих в образовательное учреждение. Система предназначена для работников приёмной комиссии и обеспечивает полный цикл обработки информации об абитуриентах: от первичного внесения данных до формирования аналитических отчётов и расчёта проходных баллов.

## Основные возможности

### Управление данными
- **CRUD-операции**: полный набор функций для создания, чтения, обновления и удаления записей абитуриентов
- **Импорт/экспорт**: загрузка данных из Excel-файлов и выгрузка в формате XLSX для внешней обработки
- **Автоматическая нумерация**: динамическое присвоение уникальных идентификаторов с поддержкой перенумерации при удалении записей
- **Валидация данных**: проверка обязательных полей и корректности формата введённых данных

### Работа с интерфейсом
- **Табличное представление**: отображение всех абитуриентов с возможностью сортировки по любому столбцу
- **Поиск в реальном времени**: быстрый поиск по любым полям записей
- **Фильтрация**: многокритериальный отбор данных по категориальным и числовым параметрам
- **Контекстные меню**: операции копирования, вставки и вырезания с поддержкой горячих клавиш

### Аналитика и отчётность
- **Анализ проходного балла**: расчёт шансов поступления с визуальной индикацией статусов (проходит/резерв/не проходит)
- **Географическая статистика**: распределение абитуриентов по регионам и городам с расчётом средних показателей
- **Источники привлечения**: анализ эффективности каналов информирования о наборе
- **Общая статистика**: сводные показатели по льготам, оригиналам документов и потребности в общежитии

### Система льгот и бонусов
- **Автоматический расчёт**: начисление дополнительных баллов в зависимости от категории льготы
- **Широкий спектр льгот**: поддержка социальных категорий, академических достижений, спортивных и творческих успехов
- **Динамическое обновление**: изменение рейтинга при смене категории льготы

## Технологический стек

### Язык программирования
- **Python 3.x**: основной язык разработки приложения

### Графический интерфейс
- **Tkinter**: стандартная библиотека для создания графических интерфейсов
- **ttk**: расширенный набор виджетов для улучшенного визуального представления

### База данных
- **Microsoft SQL Server**: СУБД для хранения данных
- **pyodbc**: драйвер для взаимодействия с SQL Server через интерфейс ODBC

### Обработка данных
- **pandas**: библиотека для работы с табличными данными и Excel-файлами
- **openpyxl**: движок для чтения и записи файлов формата XLSX

## Архитектура приложения

### Модульная структура
Приложение построено по принципу разделения ответственности с чёткой модульной организацией:
- **Слой представления**: модули форм интерфейса, изолированные друг от друга
- **Слой бизнес-логики**: классы предметной области с инкапсуляцией данных
- **Слой доступа к данным**: менеджер базы данных с абстракцией операций CRUD
- **Инфраструктурный слой**: система логирования для трассировки операций

### Паттерны проектирования
- **MVC**: разделение данных, представления и управления
- **Repository**: абстракция работы с хранилищем данных
- **Factory Method**: создание объектов справочников
- **Observer**: обновление таблицы при изменении данных

### База данных

#### Структура таблиц
Реляционная модель включает следующие сущности:
- **Applicant**: основная таблица с личными данными абитуриентов
- **Application_details**: информация о заявлении и рейтинге
- **Additional_info**: дополнительные сведения (дата посещения, примечания)
- **Education**: справочник учебных заведений
- **Parent**: данные о родителях/опекунах
- **City/Region**: географическая иерархия
- **Benefit**: справочник льгот с бонусными баллами
- **Information_source**: источники информирования

#### Целостность данных
- **Каскадные удаления**: автоматическая очистка зависимых записей
- **Внешние ключи**: обеспечение ссылочной целостности
- **Нормализация**: устранение избыточности данных
- **Индексация**: оптимизация запросов по первичным ключам

## Системные требования

### Минимальные требования
- **ОС**: Windows 7/8/10/11 или Linux с поддержкой Tkinter
- **Python**: версия 3.7 или выше
- **SQL Server**: 2014 или более поздняя версия (Express Edition подходит)
- **ODBC Driver**: версия 17 для SQL Server
- **ОЗУ**: 2 ГБ
- **Дисковое пространство**: 100 МБ для приложения + место для БД

### Рекомендуемые требования
- **ОС**: Windows 10/11
- **Python**: версия 3.10+
- **SQL Server**: 2019 или новее
- **ОЗУ**: 4 ГБ или больше
- **Дисковое пространство**: 500 МБ

## Установка и настройка

### Установка зависимостей
```bash
pip install pyodbc pandas openpyxl matplotlib
```

### Настройка базы данных
1. Установите Microsoft SQL Server (или используйте существующий экземпляр)
2. Создайте новую базу данных для приложения
3. При первом запуске структура таблиц создастся автоматически
4. Справочные данные (льготы, источники, регионы) инициализируются при первом подключении

### Конфигурация подключения
При запуске приложения укажите параметры подключения к базе данных:
- Имя сервера (например, localhost или localhost\SQLEXPRESS)
- Название базы данных
- Режим аутентификации (Windows Authentication или SQL Server Authentication)

### Запуск приложения
```bash
python main.py
```

## Функциональные особенности

### Работа с формами

#### Форма добавления абитуриента
Структурирована на три логических блока:
- **Основные данные**: ФИО, номер, код специальности, рейтинг, льготы, форма обучения, наличие оригиналов, регион, город, общежитие
- **Дополнительная информация**: дата посещения, источник информации, примечания
- **Контактные данные**: телефоны, социальные сети, информация о родителях

#### Форма редактирования
Аналогична форме добавления с предзаполненными полями текущих данных. Номер абитуриента защищён от изменения.

#### Форма отчётов
Три режима аналитики:
- Анализ проходного балла с указанием количества бюджетных мест
- Статистика по городам и регионам
- Статистика по источникам информации и общая сводка

### Автоматизация ввода

#### Форматирование данных
- **Телефоны**: автоматическое форматирование в формате +X-XXX-XXX-XX-XX
- **Даты**: форматирование в стандарте ДД.ММ.ГГГГ с разделителями
- **ФИО**: возможность ввода полного имени с автоматическим разбором на компоненты

#### Выпадающие списки
Предопределённые значения для:
- Регионов (с автоматической загрузкой из БД)
- Городов (динамическая подгрузка в зависимости от региона)
- Льгот (с отображением бонусных баллов)
- Источников информации
- Форм обучения

### Система поиска и фильтрации

#### Глобальный поиск
Поиск по всем полям таблицы с автоматическим выделением найденной записи и прокруткой к ней.

#### Расширенная фильтрация
Критерии фильтрации:
- Город проживания
- Наличие оригиналов документов
- Потребность в общежитии
- Категория льготы
- Учебное заведение

### Логирование

Система ведёт подробный журнал всех операций:
- Запуск и завершение приложения
- Подключение к базе данных
- CRUD-операции над записями
- Импорт и экспорт данных
- Ошибки и исключения

Логи сохраняются в файл с временными метками для последующего анализа.

## Безопасность и целостность данных

### Валидация входных данных
- Проверка обязательных полей перед сохранением
- Контроль формата дат и телефонов
- Валидация числовых значений (рейтинг)
- Проверка логических ограничений (даты не в будущем)

### Работа с базой данных
- Использование параметризованных запросов для защиты от SQL-инъекций
- Транзакционная обработка операций с откатом при ошибках
- Каскадные удаления для поддержания целостности
- Автоматическое управление внешними ключами

### Резервное копирование
Возможность экспорта всех данных в Excel для создания резервных копий и восстановления информации.

## Ограничения и известные особенности

- Поддержка только одного региона для каждого города
- Один родитель/опекун на абитуриента
- Одна льгота на абитуриента (при необходимости множественных льгот требуется доработка)
- Отсутствие многопользовательской работы с блокировками записей
- Экспорт только в формат Excel (без поддержки PDF или других форматов)

## Разработка и расширение

### Возможные улучшения
- Добавление ролевой модели с разграничением прав доступа
- Интеграция с почтовыми сервисами для уведомления абитуриентов
- Формирование документов (списки, приказы) по шаблонам
- Поддержка нескольких льгот для одного абитуриента
- Графики и диаграммы в разделе аналитики
- Экспорт отчётов в PDF
- Интеграция с внешними системами (ЕГЭ, региональные базы)

### Структура проекта для разработчиков
```
applicant_system/
├── main.py                 # Точка входа
├── app_table.py           # Главная форма
├── app_add_applicant.py   # Форма добавления
├── app_edit_applicant.py  # Форма редактирования
├── app_reports.py         # Модуль отчётов
├── classes.py             # Классы предметной области
├── database.py            # Менеджер БД
├── logger.py              # Система логирования
├── requirements.txt       # Зависимости проекта
└── README.md             # Документация
```

## Лицензия

Проект распространяется свободно для образовательных и коммерческих целей.

## Контакты и поддержка

По вопросам использования и предложениям по улучшению обращайтесь через систему Issues на GitHub.

---

**Примечание**: Данное приложение разработано для автоматизации работы приёмной комиссии образовательного учреждения и может быть адаптировано под специфические требования конкретной организации.
